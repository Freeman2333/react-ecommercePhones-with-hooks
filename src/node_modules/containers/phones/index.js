import React, { useContext, useEffect} from 'react'
import { Link } from 'react-router-dom'

import Layout from 'containers/layout';
import {MainContext} from '../../context/mainContext'
import {BasketContext} from '../../context/basketContext'

const Phones = () => {
	const { filteredPhones, filteredPhones:phones,loadMorePhones } = useContext(MainContext)
	const { addPhoneToBasket } = useContext(BasketContext)
	if (!filteredPhones) {
		return null
	}
	const renderPhone =(phone, index)=> {
		// const {addPhoneToBasket} = this.props
		const shortDescription = phone.description.slice(0, 60)+'...'
		return (
			<div className="col-sm-4 col-lg-4 col-md-4 book-list" key={index}>
				<div className="thumbnail">
					<img src={phone.image} alt={phone.name} className="img-thumbnail" />
					<div className="caption">
						<h4 className="pull-right">${phone.price}</h4>
						<h4>
							<Link to={`/phones/${phone.id}`}>
								{phone.name}
							</Link>
						</h4>
						<p>{shortDescription}</p>
						<p className="itemButton">
							<button className="btn btn-primary"  onClick={()=> {addPhoneToBasket(phone)}	}>Buy now!</button>
							<Link to={`/phones/${phone.id}`} className='btn btn-default'>
								More info
							</Link>
						</p>
					</div>
				</div>
			</div>
		)
	}
	
	return (
		<Layout>
			<div className="books row">
				{phones.map((phone,index)=> renderPhone(phone,index))}
			</div>
			<div className="row">
				<div className="col-md-12">
					<button className="pull-right btn btn-primary" onClick={()=>loadMorePhones()}>Load More</button>
				</div>
			</div>
		</Layout>
	)
	
}




export default Phones
